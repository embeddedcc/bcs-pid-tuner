/*! bcs-pid-tuner - v0.0.1 - 2014-12-07 */!function(){function a(a){$(".tuning .list").prepend($('<div class="row">').append([$('<div class="col-md-2">').html(a.tuning_values.error),$('<div class="col-md-2">').html(a.tuning_values.pTerm),$('<div class="col-md-2">').html(a.tuning_values.iTerm),$('<div class="col-md-2">').html(a.tuning_values.dTerm),$('<div class="col-md-2">').html(a.tuning_values.output)]))}function b(b){clearInterval(d),b.forEach(function(b,e){c.read("pid/"+e).then(function(f){var g=$(".outputs .list [data-output="+e+"] .form-group");g.find('[data-name="output"]').html(b.name);for(var h in f)"tuning"===h?g.find("[data-name=tuning]")[0].checked=f.tuning:g.find('[data-name="'+h+'"]').val(f[h]);f.tuning&&(a(f),d=setInterval(function(){c.read("pid/"+e).then(a)},1e3))})})}var c,d=null;$(document).ready(function(){$("#bcs").on("change",function(a){$("#bcs").parent().removeClass("has-success").removeClass("has-error"),c=new BCS.Device(a.target.value),c.on("ready",function(){localStorage["bcs-backup.url"]=a.target.value,$("#bcs").parent().addClass("has-success"),c.helpers.getOutputs().then(b)}).on("notReady",function(){$("#bcs").parent.addClass("has-error"),c=null})}),localStorage["bcs-backup.url"]&&($("[data-name=bcs]").val(localStorage["bcs-backup.url"]),$("[data-name=bcs]").change()),$("input[data-name]").on("change",function(a){if(c&&c.ready){var d=$(a.target),e={};e[d.attr("data-name")]="checkbox"===d.attr("type")?d[0].checked:Number(d.val()),c.write("pid/"+d.parents("form").attr("data-output"),e).then(function(){c.helpers.getOutputs().then(b)}),console.log(a.target)}})})}();